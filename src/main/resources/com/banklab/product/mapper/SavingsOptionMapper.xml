<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.banklab.product.mapper.SavingsOptionMapper">
    
    <resultMap id="SavingsOptionResultMap" type="com.banklab.product.domain.savings.SavingsOption">
        <id property="id" column="id"/>
        <result property="dclsMonth" column="dcls_month"/>
        <result property="finCoNo" column="fin_co_no"/>
        <result property="finPrdtCd" column="fin_prdt_cd"/>
        <result property="intrRateType" column="intr_rate_type"/>
        <result property="intrRateTypeNm" column="intr_rate_type_nm"/>
        <result property="rsrvType" column="rsrv_type"/>
        <result property="rsrvTypeNm" column="rsrv_type_nm"/>
        <result property="saveTrm" column="save_trm"/>
        <result property="intrRate" column="intr_rate"/>
        <result property="intrRate2" column="intr_rate2"/>
        <result property="createdAt" column="created_at"/>
        <result property="updatedAt" column="updated_at"/>
    </resultMap>

    <insert id="insertSavingsOption" parameterType="com.banklab.product.domain.savings.SavingsOption">
        INSERT INTO savings_option (
            dcls_month, fin_co_no, fin_prdt_cd,
            intr_rate_type, intr_rate_type_nm, rsrv_type, rsrv_type_nm,
            save_trm, intr_rate, intr_rate2, created_at, updated_at
        ) VALUES (
            #{dclsMonth}, #{finCoNo}, #{finPrdtCd},
            #{intrRateType}, #{intrRateTypeNm}, #{rsrvType}, #{rsrvTypeNm},
            #{saveTrm}, #{intrRate}, #{intrRate2}, NOW(), NOW()
        )
    </insert>

    <select id="findAllSavingsOptions" resultMap="SavingsOptionResultMap">
        SELECT 
            id, dcls_month, fin_co_no, fin_prdt_cd,
            intr_rate_type, intr_rate_type_nm, rsrv_type, rsrv_type_nm,
            save_trm, intr_rate, intr_rate2, created_at, updated_at
        FROM savings_option
        ORDER BY fin_co_no, fin_prdt_cd, save_trm
    </select>
    <select id="findOptionsByProduct" resultType="com.banklab.product.domain.savings.SavingsOption">
        SELECT
            id,
            dcls_month as dclsMonth,
            fin_co_no as finCoNo,
            fin_prdt_cd as finPrdtCd,
            intr_rate_type as intrRateType,
            intr_rate_type_nm as intrRateTypeNm,
            rsrv_type as rsrvType,
            rsrv_type_nm as rsrvTypeNm,
            save_trm as saveTrm,
            intr_rate as intrRate,
            intr_rate2 as intrRate2,
            created_at as createdAt,
            updated_at as updatedAt
        FROM savings_option
        WHERE dcls_month = #{dclsMonth}
          AND fin_co_no = #{finCoNo}
          AND fin_prdt_cd = #{finPrdtCd}
        ORDER BY save_trm, intr_rate_type

    </select>

    <select id="findByOptionKey" resultType="com.banklab.product.domain.savings.SavingsOption">
        SELECT
            id,
            dcls_month as dclsMonth,
            fin_co_no as finCoNo,
            fin_prdt_cd as finPrdtCd,
            intr_rate_type as intrRateType,
            intr_rate_type_nm as intrRateTypeNm,
            rsrv_type as rsrvType,
            rsrv_type_nm as rsrvTypeNm,
            save_trm as saveTrm,
            intr_rate as intrRate,
            intr_rate2 as intrRate2,
            created_at as createdAt,
            updated_at as updatedAt
        FROM savings_option
        WHERE dcls_month = #{dclsMonth}
          AND fin_co_no = #{finCoNo}
          AND fin_prdt_cd = #{finPrdtCd}
          AND intr_rate_type = #{intrRateType}
          AND rsrv_type = #{rsrvType}
          AND save_trm = #{saveTrm}
    </select>

    <update id="updateSavingsOption" parameterType="com.banklab.product.domain.savings.SavingsOption">
        UPDATE savings_option SET
            dcls_month = #{dclsMonth},
            fin_co_no = #{finCoNo},
            fin_prdt_cd = #{finPrdtCd},
            intr_rate_type = #{intrRateType},
            intr_rate_type_nm = #{intrRateTypeNm},
            rsrv_type = #{rsrvType},
            rsrv_type_nm = #{rsrvTypeNm},
            save_trm = #{saveTrm},
            intr_rate = #{intrRate},
            intr_rate2 = #{intrRate2},
            updated_at = NOW()
        WHERE id = #{id}
    </update>

    <delete id="deleteAllSavingsOptions">
        DELETE FROM savings_option
    </delete>

</mapper>
